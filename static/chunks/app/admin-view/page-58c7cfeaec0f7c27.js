(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[25],{2601:function(e,t,n){"use strict";var r,o;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(8960)},1592:function(e,t,n){Promise.resolve().then(n.bind(n,364))},364:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var r=n(7437),o=n(2329),i=n(9166),a=n(341),c=n(2265),s=n(6535);function l(){let{allOrdersForAllUsers:e,setAllOrdersForAllUsers:t,user:n,pageLevelLoader:l,setPageLevelLoader:u,componentLevelLoader:d,setComponentLevelLoader:f}=(0,c.useContext)(i.GlobalContext);async function p(){u(!0);let e=await (0,a.Bi)();console.log(e),e.success?(u(!1),t(e.data&&e.data.length?e.data.filter(e=>e.user._id!==n._id):[])):u(!1)}async function m(e){f({loading:!0,id:e._id}),(await (0,a.wr)({...e,isProcessing:!1})).success?(f({loading:!1,id:""}),p()):f({loading:!0,id:""})}return((0,c.useEffect)(()=>{null!==n&&p()},[n]),console.log(e),l)?(0,r.jsx)("div",{className:"w-full min-h-screen flex justify-center items-center",children:(0,r.jsx)(s.Z,{color:"#000000",loading:l,size:30,"data-testid":"loader"})}):(0,r.jsx)("section",{children:(0,r.jsx)("div",{className:"mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"px-4 py-6 sm:px-8 sm:py-10",children:(0,r.jsx)("div",{className:"flow-root",children:e&&e.length?(0,r.jsx)("ul",{className:"flex flex-col gap-4",children:e.map(e=>{var t,n;return(0,r.jsxs)("li",{className:"bg-gray-200 shadow p-5 flex flex-col space-y-3 py-6 text-left",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)("h1",{className:"font-bold text-lg mb-3 flex-1",children:["Поръчка номер: ",e._id]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("p",{className:"mr-3 text-sm font-medium text-gray-900",children:"Потребиител :"}),(0,r.jsx)("p",{className:"text-sm  font-semibold text-gray-900",children:null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.name})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("p",{className:"mr-3 text-sm font-medium text-gray-900",children:"Потребителски email :"}),(0,r.jsx)("p",{className:"text-sm  font-semibold text-gray-900",children:null==e?void 0:null===(n=e.user)||void 0===n?void 0:n.email})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("p",{className:"mr-3 text-sm font-medium text-gray-900",children:"Заплатена сума. :"}),(0,r.jsxs)("p",{className:"text-sm  font-semibold text-gray-900",children:["$",null==e?void 0:e.totalPrice]})]})]})]}),(0,r.jsx)("div",{className:"flex gap-2",children:e.orderItems.map((e,t)=>(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)("img",{alt:"Order Item",className:"h-24 w-24 max-w-full rounded-lg object-cover",src:e&&e.product&&e.product.imageUrl})},t))}),(0,r.jsxs)("div",{className:"flex gap-5",children:[(0,r.jsx)("button",{className:"disabled:opacity-50 mt-5 mr-5  inline-block bg-black text-white px-5 py-3 text-xs font-medium uppercase tracking-wide",children:e.isProcessing?"Поръчката се обработва":"Поръчката е доставена"}),(0,r.jsx)("button",{onClick:()=>m(e),disabled:!e.isProcessing,className:"disabled:opacity-50 mt-5 mr-5  inline-block bg-black text-white px-5 py-3 text-xs font-medium uppercase tracking-wide",children:d&&d.loading&&d.id===e._id?(0,r.jsx)(o.Z,{text:"Обновяване на поръчката",color:"#ffffff",loading:d&&d.loading}):"Актуализиране на поръчката"})]})]},e._id)})}):null})})})})})}},2329:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7437),o=n(6535);function i(e){let{text:t,color:n,loading:i,size:a}=e;return(0,r.jsxs)("span",{className:"flex gap-1 items-center",children:[t,(0,r.jsx)(o.Z,{color:n,loading:i,size:a||10,"data-testid":"loader"})]})}},9166:function(e,t,n){"use strict";n.r(t),n.d(t,{GlobalContext:function(){return c},default:function(){return d},initialCheckoutFormData:function(){return s}});var r=n(7437),o=n(1490),i=n(4033),a=n(2265);let c=(0,a.createContext)(null),s={shippingAddress:{},paymentMethod:"",totalPrice:0,isPaid:!1,paidAt:new Date,isProcessing:!0},l=["cart","checkout","account","orders","admin-view"],u=["/admin-view","/admin-view/add-product","/admin-view/all-products"];function d(e){let{children:t}=e,[n,d]=(0,a.useState)(!1),[f,p]=(0,a.useState)(!0),[m,h]=(0,a.useState)({loading:!1,id:""}),[v,x]=(0,a.useState)(null),[g,y]=(0,a.useState)(null),[b,w]=(0,a.useState)(null),[j,N]=(0,a.useState)(!1),[O,k]=(0,a.useState)([]),[S,_]=(0,a.useState)([]),[E,T]=(0,a.useState)({fullName:"",city:"",country:"",postalCode:"",address:""}),[C,P]=(0,a.useState)(s),[I,R]=(0,a.useState)([]),[A,z]=(0,a.useState)(null),[B,U]=(0,a.useState)([]),Z=(0,i.useRouter)(),L=(0,i.usePathname)();return(0,a.useEffect)(()=>{if(void 0!==o.Z.get("token")){x(!0);let e=JSON.parse(localStorage.getItem("user"))||{},t=JSON.parse(localStorage.getItem("cartItems"))||[];y(e),k(t)}else x(!1),y({})},[o.Z]),(0,a.useEffect)(()=>{"/register"!==L&&!L.includes("product")&&"/"!==L&&g&&0===Object.keys(g).length&&l.includes(L)>-1&&Z.push("/login")},[g,L]),(0,a.useEffect)(()=>{null!==g&&g&&Object.keys(g).length>0&&(null==g?void 0:g.role)!=="admin"&&u.indexOf(L)>-1&&Z.push("/unauthorized-page")},[g,L]),(0,r.jsx)(c.Provider,{value:{showNavmodel:n,setShowNavmodel:d,pageLevelLoader:f,setPageLevelLoader:p,isAuthUser:v,setIsAuthUser:x,user:g,setUser:y,componentLevelLoader:m,setComponentLevelLoader:h,currentUpdatedProduct:b,setCurrentUpdatedProduct:w,showCartModel:j,setShowCartModel:N,cartItems:O,setCartItems:k,addresses:S,setAddresses:_,addressFormData:E,setAddressFormData:T,checkoutFormData:C,setCheckoutFormData:P,allOrdersForUser:I,setAllOrdersForUser:R,orderDetails:A,setOrderDetails:z,allOrdersForAllUsers:B,setAllOrdersForAllUsers:U},children:t})}},341:function(e,t,n){"use strict";n.d(t,{Bi:function(){return l},ax:function(){return a},mg:function(){return i},s$:function(){return c},wr:function(){return u}});var r=n(1490),o=n(2601);let i=async e=>{try{let t=await fetch("/api/order/create-order",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r.Z.get("token"))},body:JSON.stringify(e)});return await t.json()}catch(e){console.log(e)}},a=async e=>{try{let t=await fetch("/api/order/get-all-orders?id=".concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(r.Z.get("token"))}});return await t.json()}catch(e){console.log(e)}},c=async e=>{try{let t=await fetch("/api/order/order-details?id=".concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(r.Z.get("token"))}});return await t.json()}catch(e){console.log(e)}},s=o.env.NEXT_PUBLIC_API_URL||"http://localhost:3000",l=async()=>{try{let e=await fetch("".concat(s,"/api/admin/orders/get-all-orders"),{method:"GET",headers:{Authorization:"Bearer ".concat(r.Z.get("token"))}});return await e.json()}catch(e){console.log(" еее ама неска пих"),console.log(e)}},u=async e=>{try{let t=await fetch("".concat(s,"/api/admin/orders/update-order"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r.Z.get("token"))},body:JSON.stringify(e)});return await t.json()}catch(e){console.log(e)}}},8960:function(e){!function(){var t={229:function(e){var t,n,r,o=e.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var s=[],l=!1,u=-1;function d(){l&&r&&(l=!1,r.length?s=r.concat(s):u=-1,s.length&&f())}function f(){if(!l){var e=c(d);l=!0;for(var t=s.length;t;){for(r=s,s=[];++u<t;)r&&r[u].run();u=-1,t=s.length}r=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new p(e,t)),1!==s.length||l||c(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}},a=!0;try{t[e](i,i.exports,r),a=!1}finally{a&&delete n[e]}return i.exports}r.ab="//";var o=r(229);e.exports=o}()},622:function(e,t,n){"use strict";var r=n(2265),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,i={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!s.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:l,ref:u,props:i,_owner:c.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},7437:function(e,t,n){"use strict";e.exports=n(622)},4033:function(e,t,n){e.exports=n(5313)},6535:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(2265),o={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function i(e){var t=function(e){if("number"==typeof e)return{value:e,unit:"px"};var t,n=(e.match(/^[0-9.]*/)||"").toString();t=n.includes(".")?parseFloat(n):parseInt(n,10);var r=(e.match(/[^0-9]*$/)||"").toString();return o[r]?{value:t,unit:r}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(t,"px.")),{value:t,unit:"px"})}(e);return"".concat(t.value).concat(t.unit)}var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)0>t.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},s=function(e,t,n){var r="react-spinners-".concat(e,"-").concat(n);if("undefined"==typeof window||!window.document)return r;var o=document.createElement("style");document.head.appendChild(o);var i=o.sheet,a="\n    @keyframes ".concat(r," {\n      ").concat(t,"\n    }\n  ");return i&&i.insertRule(a,0),r}("PulseLoader","0% {transform: scale(1); opacity: 1} 45% {transform: scale(0.1); opacity: 0.7} 80% {transform: scale(1); opacity: 1}","pulse"),l=function(e){var t=e.loading,n=e.color,o=void 0===n?"#000000":n,l=e.speedMultiplier,u=void 0===l?1:l,d=e.cssOverride,f=e.size,p=void 0===f?15:f,m=e.margin,h=void 0===m?2:m,v=c(e,["loading","color","speedMultiplier","cssOverride","size","margin"]),x=a({display:"inherit"},void 0===d?{}:d),g=function(e){return{backgroundColor:o,width:i(p),height:i(p),margin:i(h),borderRadius:"100%",display:"inline-block",animation:"".concat(s," ").concat(.75/u,"s ").concat(.12*e/u,"s infinite cubic-bezier(0.2, 0.68, 0.18, 1.08)"),animationFillMode:"both"}};return void 0===t||t?r.createElement("span",a({style:x},v),r.createElement("span",{style:g(1)}),r.createElement("span",{style:g(2)}),r.createElement("span",{style:g(3)})):null}},1490:function(e,t,n){"use strict";/*! js-cookie v3.0.5 | MIT */function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}n.d(t,{Z:function(){return o}});var o=function e(t,n){function o(e,o,i){if("undefined"!=typeof document){"number"==typeof(i=r({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in i)i[c]&&(a+="; "+c,!0!==i[c]&&(a+="="+i[c].split(";")[0]));return document.cookie=e+"="+t.write(o,e)+a}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var i=n[o].split("="),a=i.slice(1).join("=");try{var c=decodeURIComponent(i[0]);if(r[c]=t.read(a,c),e===c)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){o(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}},function(e){e.O(0,[971,938,744],function(){return e(e.s=1592)}),_N_E=e.O()}]);