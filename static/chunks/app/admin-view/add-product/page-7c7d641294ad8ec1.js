(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[633,727,213,434,142,858],{1871:function(e,t,n){Promise.resolve().then(n.bind(n,453))},453:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var l=n(7437),a=n(9893),i=n(4011);function o(e){let{data:t,selected:n=[],onClick:a}=e;return t&&t.length?(0,l.jsx)("div",{className:"mt-3 flex flex-wrap items-center gap-1",children:t.map(e=>(0,l.jsx)("label",{onClick:()=>a(e),className:"cursor-pointer ".concat(n&&n.length&&-1!==n.map(e=>e.id).indexOf(e.id)?"bg-black":""),children:(0,l.jsx)("span",{className:"rounded-lg border border-black px-6 py-2 font-bold ".concat(n&&n.length&&-1!==n.map(e=>e.id).indexOf(e.id)?"text-white":""),children:e.label})},e.id))}):null}var r=n(2329),c=n(3151),s=n(9166),d=n(9890),u=n(7121),p=n(994),m=n(9584),h=n(4033),f=n(2265),b=n(171);let g=(0,p.ZF)(u.qe),y=(0,m.cF)(g,u.mO),x=e=>{let t=Date.now(),n=Math.random().toString(36).substring(2,12);return"".concat(e.name,"-").concat(t,"-").concat(n)};async function w(e){let t=x(e),n=(0,m.iH)(y,"ecommerce/".concat(t)),l=(0,m.B0)(n,e);return new Promise((e,t)=>{l.on("state_changed",e=>{},e=>{console.log(e),t(e)},()=>{(0,m.Jt)(l.snapshot.ref).then(t=>e(t)).catch(e=>t(e))})})}let v={name:"",price:0,description:"",category:"men",sizes:[],deliveryInfo:"",onSale:"no",imageUrl:"",priceDrop:0};function j(){let[e,t]=(0,f.useState)(v),{componentLevelLoader:n,setComponentLevelLoader:p,currentUpdatedProduct:m,setCurrentUpdatedProduct:g}=(0,f.useContext)(s.GlobalContext);console.log(m);let y=(0,h.useRouter)();async function x(n){let l=await w(n.target.files[0]);""!==l&&t({...e,imageUrl:l})}async function j(){p({loading:!0,id:""});let n=null!==m?await (0,d.Tw)(e):await (0,d.xg)(e);console.log(n),n.success?(p({loading:!1,id:""}),b.Am.success(n.message,{position:b.Am.POSITION.TOP_RIGHT}),t(v),g(null),setTimeout(()=>{y.push("/admin-view/all-products")},1e3)):(b.Am.error(n.message,{position:b.Am.POSITION.TOP_RIGHT}),p({loading:!1,id:""}),t(v))}return(0,f.useEffect)(()=>{null!==m&&t(m)},[m]),console.log(e),(0,l.jsxs)("div",{className:"w-full mt-5 mr-0 mb-0 ml-0 relative",children:[(0,l.jsx)("div",{className:"flex flex-col items-start justify-start p-10 bg-white shadow-2xl rounded-xl relative",children:(0,l.jsxs)("div",{className:"w-full mt-6 mr-0 mb-0 ml-0 space-y-8",children:[(0,l.jsx)("input",{accept:"image/*",max:"1000000",type:"file",onChange:x}),(0,l.jsxs)("div",{className:"flex gap-2 flex-col",children:[(0,l.jsx)("label",{children:"Налични размери"}),(0,l.jsx)(o,{selected:e.sizes,onClick:function(n){let l=[...e.sizes];-1===l.findIndex(e=>e.id===n.id)?l.push(n):l=l.filter(e=>e.id!==n.id),t({...e,sizes:l})},data:u.jJ})]}),u.d2.map(n=>"input"===n.componentType?(0,l.jsx)(a.Z,{type:n.type,placeholder:n.placeholder,label:n.label,value:e[n.id],onChange:l=>{t({...e,[n.id]:l.target.value})}}):"select"===n.componentType?(0,l.jsx)(i.Z,{label:n.label,options:n.options,value:e[n.id],onChange:l=>{t({...e,[n.id]:l.target.value})}}):null),(0,l.jsx)("button",{onClick:j,className:"inline-flex w-full items-center justify-center bg-black px-6 py-4 text-lg text-white font-medium uppercase tracking-wide",children:n&&n.loading?(0,l.jsx)(r.Z,{text:null!==m?"Обновяване на продукта":"Добавяне на продукта",color:"#ffffff",loading:n&&n.loading}):null!==m?"Обнови продукт":"Добави продукт"})]})}),(0,l.jsx)(c.Z,{})]})}},9893:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var l=n(7437);function a(e){let{label:t,placeholder:n,onChange:a,value:i,type:o}=e;return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("p",{className:" pt-0 pr-2 pb-0 pl-2 absolute -mt-3 mr-0 mb-0 ml-2 font-medium text-gray-600 bg-white",children:t}),(0,l.jsx)("input",{placeholder:n,type:o||"text",value:i,onChange:a,className:"border placeholder-gray-400 focus:outline-none focus:border-black w-full pt-4 pr-4 pb-4 pl-4 mr-0 mt-0 ml-0 text-base block bg-white border-gray-300 rounded-md"})]})}},4011:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var l=n(7437);function a(e){let{label:t,value:n,onChange:a,options:i=[]}=e;return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("p",{className:" pt-0 pr-2 absolute pb-0 pl-2 -mt-3 mr-0 mb-0 ml-2 font-medium text-gray-600 bg-white",children:t}),(0,l.jsx)("select",{value:n,onChange:a,className:"border placeholder-gray-400 focus:outline-none focus:border-black w-full pt-4 pr-4 pb-4 pl-4 mr-0 mt-0 ml-0 text-base block bg-white border-gray-300 rounded-md",children:i&&i.length?i.map(e=>(0,l.jsx)("option",{id:e.id,value:e.id,children:e.label},e.id)):(0,l.jsx)("option",{id:"",value:"",children:"Избери"})})]})}},2329:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var l=n(7437),a=n(6535);function i(e){let{text:t,color:n,loading:i,size:o}=e;return(0,l.jsxs)("span",{className:"flex gap-1 items-center",children:[t,(0,l.jsx)(a.Z,{color:n,loading:i,size:o||10,"data-testid":"loader"})]})}},3151:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var l=n(7437),a=n(171);function i(){return(0,l.jsx)(a.Ix,{position:"top-right",autoClose:4e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light",rtl:!1})}n(8062)},9166:function(e,t,n){"use strict";n.r(t),n.d(t,{GlobalContext:function(){return r},default:function(){return u},initialCheckoutFormData:function(){return c}});var l=n(7437),a=n(1490),i=n(4033),o=n(2265);let r=(0,o.createContext)(null),c={shippingAddress:{},paymentMethod:"",totalPrice:0,isPaid:!1,paidAt:new Date,isProcessing:!0},s=["cart","checkout","account","orders","admin-view"],d=["/admin-view","/admin-view/add-product","/admin-view/all-products"];function u(e){let{children:t}=e,[n,u]=(0,o.useState)(!1),[p,m]=(0,o.useState)(!0),[h,f]=(0,o.useState)({loading:!1,id:""}),[b,g]=(0,o.useState)(null),[y,x]=(0,o.useState)(null),[w,v]=(0,o.useState)(null),[j,T]=(0,o.useState)(!1),[k,S]=(0,o.useState)([]),[N,O]=(0,o.useState)([]),[I,C]=(0,o.useState)({fullName:"",city:"",country:"",postalCode:"",address:""}),[P,Z]=(0,o.useState)(c),[E,A]=(0,o.useState)([]),[_,z]=(0,o.useState)(null),[D,B]=(0,o.useState)([]),G=(0,i.useRouter)(),J=(0,i.usePathname)();return(0,o.useEffect)(()=>{if(void 0!==a.Z.get("token")){g(!0);let e=JSON.parse(localStorage.getItem("user"))||{},t=JSON.parse(localStorage.getItem("cartItems"))||[];x(e),S(t)}else g(!1),x({})},[a.Z]),(0,o.useEffect)(()=>{"/register"!==J&&!J.includes("product")&&"/"!==J&&y&&0===Object.keys(y).length&&s.includes(J)>-1&&G.push("/login")},[y,J]),(0,o.useEffect)(()=>{null!==y&&y&&Object.keys(y).length>0&&(null==y?void 0:y.role)!=="admin"&&d.indexOf(J)>-1&&G.push("/unauthorized-page")},[y,J]),(0,l.jsx)(r.Provider,{value:{showNavmodel:n,setShowNavmodel:u,pageLevelLoader:p,setPageLevelLoader:m,isAuthUser:b,setIsAuthUser:g,user:y,setUser:x,componentLevelLoader:h,setComponentLevelLoader:f,currentUpdatedProduct:w,setCurrentUpdatedProduct:v,showCartModel:j,setShowCartModel:T,cartItems:k,setCartItems:S,addresses:N,setAddresses:O,addressFormData:I,setAddressFormData:C,checkoutFormData:P,setCheckoutFormData:Z,allOrdersForUser:E,setAllOrdersForUser:A,orderDetails:_,setOrderDetails:z,allOrdersForAllUsers:D,setAllOrdersForAllUsers:B},children:t})}},9890:function(e,t,n){"use strict";n.d(t,{Tw:function(){return c},ak:function(){return s},c0:function(){return r},xg:function(){return i}});var l=n(1490),a=n(2601);let i=async e=>{try{let t=await fetch("/api/admin/add-product",{method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer ".concat(l.Z.get("token"))},body:JSON.stringify(e)});return await t.json()}catch(e){console.log(e)}},o=a.env.NEXT_PUBLIC_API_URL||"http://localhost:3000",r=async()=>{try{let e=await fetch("".concat(o,"/api/admin/all-products"),{method:"GET",cache:"no-store"});return await e.json()}catch(e){console.log(e)}},c=async e=>{try{let t=await fetch("/api/admin/update-product",{method:"PUT",headers:{"content-type":"application/json",Authorization:"Bearer ".concat(l.Z.get("token"))},cache:"no-store",body:JSON.stringify(e)});return await t.json()}catch(e){console.log(e)}},s=async e=>{try{let t=await fetch("/api/admin/delete-product?id=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(l.Z.get("token"))}});return await t.json()}catch(e){console.log(e)}}},7121:function(e,t,n){"use strict";n.d(t,{GP:function(){return s},GU:function(){return a},Hp:function(){return i},d2:function(){return r},jJ:function(){return c},mO:function(){return u},p8:function(){return l},qe:function(){return d},vV:function(){return o}}),n(994),n(9584);let l=[{id:"home",label:"Home",path:"/"},{id:"listing",label:"Всички продукти",path:"/product/listing/all-products"},{id:"listingMen",label:"Мъже",path:"/product/listing/men"},{id:"listingWomen",label:"Жени",path:"/product/listing/women"},{id:"listingKids",label:"Деца",path:"/product/listing/kids"}],a=[{id:"adminListing",label:"Обновяване на продукт",path:"/admin-view/all-products"},{id:"adminNewProduct",label:"Добавяне на продукти",path:"/admin-view/add-product"},{id:"orders",label:"Поръчки",path:"/admin-view/orders"}],i=[{id:"name",type:"text",placeholder:"Въведете вашето име",label:"Име",componentType:"input"},{id:"email",type:"email",placeholder:"Въведете email адрес",label:"Email адрес",componentType:"input"},{id:"password",type:"password",placeholder:"Въведете парола",label:"Парола",componentType:"input"},{id:"role",type:"",placeholder:"",label:"Role",componentType:"select",options:[{id:"admin",label:"Admin"},{id:"customer",label:"customer"}]}],o=[{id:"email",type:"email",placeholder:"Въведете email адрес",label:"Email",componentType:"input"},{id:"password",type:"password",placeholder:"Въведете парола",label:"Парола",componentType:"input"}],r=[{id:"name",type:"text",placeholder:"Enter name",label:"Име",componentType:"input"},{id:"price",type:"number",placeholder:"Въведете цена",label:"Цена",componentType:"input"},{id:"description",type:"text",placeholder:"Въведете описание",label:"Описание",componentType:"input"},{id:"category",type:"",placeholder:"",label:"Категория",componentType:"select",options:[{id:"men",label:"Мъже"},{id:"women",label:"Жени"},{id:"kids",label:"Деца"}]},{id:"deliveryInfo",type:"text",placeholder:"Въведете адрес",label:"Адрес",componentType:"input"},{id:"onSale",type:"",placeholder:"",label:"Промоция",componentType:"select",options:[{id:"yes",label:"Да"},{id:"no",label:"Не"}]},{id:"priceDrop",type:"number",placeholder:"Въведете намалението в %",label:"Намаление",componentType:"input"}],c=[{id:"s",label:"S"},{id:"m",label:"M"},{id:"l",label:"L"}],s=[{id:"fullName",type:"input",placeholder:"Въведете вашите имена",label:"Три имена",componentType:"input"},{id:"address",type:"input",placeholder:"Въведете адрес",label:"Адрес",componentType:"input"},{id:"city",type:"input",placeholder:"Въведете град",label:"Град",componentType:"input"},{id:"country",type:"input",placeholder:"Въведете държава",label:"Държава",componentType:"input"},{id:"postalCode",type:"input",placeholder:"Въведете пощенски код",label:"Пощенски код",componentType:"input"}],d={apiKey:"AIzaSyD5Alvae8H3a2To1DRjvweJVUuUwYTiF9I",authDomain:"modernik.firebaseapp.com",projectId:"modernik",storageBucket:"modernik.appspot.com",messagingSenderId:"626955762261",appId:"1:626955762261:web:02f40e7c046a9e779372dc",measurementId:"G-BZL21K1RQM"},u="gs://modernik.appspot.com"},8062:function(){}},function(e){e.O(0,[788,226,971,938,744],function(){return e(e.s=1871)}),_N_E=e.O()}]);