(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{8871:function(e,t,n){Promise.resolve().then(n.t.bind(n,3385,23)),Promise.resolve().then(n.t.bind(n,7844,23)),Promise.resolve().then(n.bind(n,8801)),Promise.resolve().then(n.bind(n,9166))},2329:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var l=n(7437),i=n(6535);function a(e){let{text:t,color:n,loading:a,size:o}=e;return(0,l.jsxs)("span",{className:"flex gap-1 items-center",children:[t,(0,l.jsx)(i.Z,{color:n,loading:a,size:o||10,"data-testid":"loader"})]})}},8801:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var l=n(7437),i=n(9166),a=n(7121),o=n(2265),s=n(9805),r=n(9220);function c(e){let{modelTitle:t,mainContent:n,showButtons:i,buttonComponent:a,show:c,setShow:d,showmodelTitle:u}=e;return(0,l.jsx)(s.u.Root,{show:c,as:o.Fragment,children:(0,l.jsxs)(r.V,{as:"div",className:"relative z-10",onClose:d,children:[(0,l.jsx)(s.u.Child,{as:o.Fragment,enter:"ease-in-out duration-900",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 overflow-hidden",children:(0,l.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:(0,l.jsx)("div",{className:"fixed inset-y-0 right-0 flex max-w-full pl-10",children:(0,l.jsx)(s.u.Child,{as:o.Fragment,enter:"ease-in-out duration-900",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-500",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)(r.V.Panel,{className:"w-screen max-w-md",children:(0,l.jsxs)("div",{className:"flex h-full flex-col overflow-y-scroll bg-white shadow-xl",children:[(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 py-6 sm:px-6",children:[u?(0,l.jsx)("div",{className:"flex items-start justify-between",children:(0,l.jsx)(r.V.Title,{children:t})}):null,(0,l.jsx)("div",{className:"mt-20",children:n})]}),i?(0,l.jsx)("div",{className:"border-none px-4 py-6 sm:px-6",children:a}):null]})})})})})})]})})}var d=n(1490),u=n(4033),p=n(7746),m=n(171),h=n(2329);function x(){let{showCartModel:e,setShowCartModel:t,cartItems:n,setCartItems:a,user:s,setComponentLevelLoader:r,componentLevelLoader:d}=(0,o.useContext)(i.GlobalContext),x=(0,u.useRouter)();async function f(){let e=await (0,p.tQ)(null==s?void 0:s._id);if(e.success){let t=e.data&&e.data.length?e.data.map(e=>({...e,productID:{...e.productID,price:"yes"===e.productID.onSale?parseInt((e.productID.price-e.productID.price*(e.productID.priceDrop/100)).toFixed(2)):e.productID.price}})):[];a(t),localStorage.setItem("cartItems",JSON.stringify(t))}console.log(e)}async function b(e){r({loading:!0,id:e});let t=await (0,p.EI)(e);t.success?(r({loading:!1,id:""}),m.Am.success(t.message,{position:m.Am.POSITION.TOP_RIGHT}),f()):(m.Am.error(t.message,{position:m.Am.POSITION.TOP_RIGHT}),r({loading:!1,id:e}))}return(0,o.useEffect)(()=>{null!==s&&f()},[s]),(0,l.jsx)(c,{showButtons:!0,show:e,setShow:t,mainContent:n&&n.length?(0,l.jsx)("ul",{role:"list",className:"-my-6 divide-y divide-gray-300",children:n.map(e=>(0,l.jsxs)("li",{className:"flex py-6",children:[(0,l.jsx)("div",{className:"h-24 w-24 flex-shrink-0 overflow-hidden rounded-md border border-gray-200",children:(0,l.jsx)("img",{src:e&&e.productID&&e.productID.imageUrl,alt:"Cart Item",className:"h-full w-full object-cover object-center"})}),(0,l.jsxs)("div",{className:"ml-4 flex flex-1 flex-col",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"flex justify-between text-base font-medium text-gray-900",children:(0,l.jsx)("h3",{children:(0,l.jsx)("a",{children:e&&e.productID&&e.productID.name})})}),(0,l.jsxs)("p",{className:"mt-1 text-sm text-gray-600",children:["$",e&&e.productID&&e.productID.price]})]}),(0,l.jsx)("div",{className:"flex flex-1 items-end justify-between text-sm",children:(0,l.jsx)("button",{type:"button",className:"font-medium text-yellow-600 sm:order-2",onClick:()=>b(e._id),children:d&&d.loading&&d.id===e._id?(0,l.jsx)(h.Z,{text:"Премахване",color:"#000000",loading:d&&d.loading}):"Премахни"})})]})]},e.id))}):null,buttonComponent:(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)("button",{type:"button",onClick:()=>{x.push("/cart"),t(!1)},className:"mt-1.5 w-full inline-block bg-black text-white px-5 py-3 text-xs font-medium uppercase tracking-wide",children:"Към количката"}),(0,l.jsx)("button",{disabled:n&&0===n.length,type:"button",onClick:()=>{x.push("/checkout"),t(!1)},className:"mt-1.5 w-full inline-block bg-black text-white px-5 py-3 text-xs font-medium uppercase tracking-wide disabled:opacity-50",children:"Плащане"}),(0,l.jsx)("div",{className:"mt-6 flex justify-center text-center text-sm text-gray-600",children:(0,l.jsxs)("button",{type:"button",className:"font-medium text-grey",children:["Продължи пазаруването",(0,l.jsx)("span",{"aria-hidden":"true",children:" →"})]})})]})})}function f(e){let{ismodelView:t=!1,isAdminView:n,router:i}=e;return(0,l.jsx)("div",{className:"items-center justify-between w-full md:flex md:w-auto ".concat(t?"":"hidden"),id:"nav-items",children:(0,l.jsx)("ul",{className:"flex flex-col p-4 md:p-0 mt-4 font-medium  rounded-lg md:flex-row md:space-x-8 md:mt-0 md:border-0 bg-white ".concat(t?"border-none":"border border-gray-100"),children:n?a.GU.map(e=>(0,l.jsx)("li",{className:"cursor-pointer block py-2 pl-3 pr-4 text-gray-900 rounded md:p-0",onClick:()=>i.push(e.path),children:e.label},e.id)):a.p8.map(e=>(0,l.jsx)("li",{className:"cursor-pointer block py-2 pl-3 pr-4 text-gray-900 rounded md:p-0",onClick:()=>i.push(e.path),children:e.label},e.id))})})}function b(){let{showNavmodel:e,setShowNavmodel:t}=(0,o.useContext)(i.GlobalContext),{user:n,isAuthUser:a,setIsAuthUser:s,setUser:r,currentUpdatedProduct:p,setCurrentUpdatedProduct:m,showCartModel:h,setShowCartModel:b}=(0,o.useContext)(i.GlobalContext),y=(0,u.usePathname)(),g=(0,u.useRouter)();(0,o.useEffect)(()=>{"/admin-view/add-product"!==y&&null!==p&&m(null)},[y]);let w=y.includes("admin-view");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("nav",{className:"bg-white fixed w-full z-20 top-0 left-0 border-b border-gray-200",children:(0,l.jsxs)("div",{className:"max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4",children:[(0,l.jsx)("div",{onClick:()=>g.push("/"),className:"flex items-center cursor-pointer",children:(0,l.jsx)("span",{className:"slef-center text-2xl font-semibold whitespace-nowrap",children:"Модерник"})}),(0,l.jsxs)("div",{className:"flex md:order-2 gap-2",children:[!w&&a?(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)("button",{className:"mt-1.5 inline-block bg-black px-5 py-3 text-xs font-medium upprcase tracking-wide text-white uppercase",onClick:()=>g.push("/account"),children:"Акаунт"}),(0,l.jsx)("button",{className:"mt-1.5 inline-block bg-black px-5 py-3 text-xs font-medium upprcase tracking-wide text-white uppercase",onClick:()=>b(!0),children:"Количка \uD83D\uDED2"})]}):null,(null==n?void 0:n.role)==="admin"?w?(0,l.jsx)("button",{className:"mt-1.5 inline-block bg-black px-5 py-3 text-xs font-medium upprcase tracking-wide text-white uppercase",onClick:()=>g.push("/"),children:"Клиентски изглед"}):(0,l.jsx)("button",{onClick:()=>g.push("/admin-view"),className:"mt-1.5 inline-block bg-black px-5 py-3 text-xs font-medium upprcase tracking-wide text-white uppercase",children:"Админ"}):null,a?(0,l.jsx)("button",{onClick:function(){s(!1),r(null),d.Z.remove("token"),localStorage.clear(),g.push("/")},className:"mt-1.5 inline-block bg-black px-5 py-3 text-xs font-medium upprcase tracking-wide text-white uppercase",children:"Излез"}):(0,l.jsx)("button",{onClick:()=>g.push("/login"),className:"mt-1.5 inline-block bg-black px-5 py-3 text-xs font-medium upprcase tracking-wide text-white uppercase",children:"Влез"}),(0,l.jsxs)("button",{"data-collapse-toggle":"navbar-sticky",type:"button",className:"inline-flex items-center p-2 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600","aria-controls":"navbar-sticky","aria-expanded":"false",onClick:()=>t(!0),children:[(0,l.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,l.jsx)("svg",{className:"w-6 h-6","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{"fill-rule":"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"})})]})]}),(0,l.jsx)(f,{router:g,isAdminView:w})]})}),(0,l.jsx)(c,{showmodelTitle:!1,mainContent:(0,l.jsx)(f,{router:g,ismodelView:!0,isAdminView:w}),show:e,setShow:t}),h&&(0,l.jsx)(x,{})]})}},9166:function(e,t,n){"use strict";n.r(t),n.d(t,{GlobalContext:function(){return s},default:function(){return u},initialCheckoutFormData:function(){return r}});var l=n(7437),i=n(1490),a=n(4033),o=n(2265);let s=(0,o.createContext)(null),r={shippingAddress:{},paymentMethod:"",totalPrice:0,isPaid:!1,paidAt:new Date,isProcessing:!0},c=["cart","checkout","account","orders","admin-view"],d=["/admin-view","/admin-view/add-product","/admin-view/all-products"];function u(e){let{children:t}=e,[n,u]=(0,o.useState)(!1),[p,m]=(0,o.useState)(!0),[h,x]=(0,o.useState)({loading:!1,id:""}),[f,b]=(0,o.useState)(null),[y,g]=(0,o.useState)(null),[w,j]=(0,o.useState)(null),[v,k]=(0,o.useState)(!1),[N,I]=(0,o.useState)([]),[T,C]=(0,o.useState)([]),[S,D]=(0,o.useState)({fullName:"",city:"",country:"",postalCode:"",address:""}),[E,O]=(0,o.useState)(r),[P,A]=(0,o.useState)([]),[F,z]=(0,o.useState)(null),[G,_]=(0,o.useState)([]),Z=(0,a.useRouter)(),R=(0,a.usePathname)();return(0,o.useEffect)(()=>{if(void 0!==i.Z.get("token")){b(!0);let e=JSON.parse(localStorage.getItem("user"))||{},t=JSON.parse(localStorage.getItem("cartItems"))||[];g(e),I(t)}else b(!1),g({})},[i.Z]),(0,o.useEffect)(()=>{"/register"!==R&&!R.includes("product")&&"/"!==R&&y&&0===Object.keys(y).length&&c.includes(R)>-1&&Z.push("/login")},[y,R]),(0,o.useEffect)(()=>{null!==y&&y&&Object.keys(y).length>0&&(null==y?void 0:y.role)!=="admin"&&d.indexOf(R)>-1&&Z.push("/unauthorized-page")},[y,R]),(0,l.jsx)(s.Provider,{value:{showNavmodel:n,setShowNavmodel:u,pageLevelLoader:p,setPageLevelLoader:m,isAuthUser:f,setIsAuthUser:b,user:y,setUser:g,componentLevelLoader:h,setComponentLevelLoader:x,currentUpdatedProduct:w,setCurrentUpdatedProduct:j,showCartModel:v,setShowCartModel:k,cartItems:N,setCartItems:I,addresses:T,setAddresses:C,addressFormData:S,setAddressFormData:D,checkoutFormData:E,setCheckoutFormData:O,allOrdersForUser:P,setAllOrdersForUser:A,orderDetails:F,setOrderDetails:z,allOrdersForAllUsers:G,setAllOrdersForAllUsers:_},children:t})}},7746:function(e,t,n){"use strict";n.d(t,{EI:function(){return o},Xq:function(){return i},tQ:function(){return a}});var l=n(1490);let i=async e=>{try{let t=await fetch("/api/cart/add-to-cart",{method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer ".concat(l.Z.get("token"))},body:JSON.stringify(e)});return await t.json()}catch(e){console.log(e)}},a=async e=>{try{let t=await fetch("/api/cart/all-cart-items?id=".concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(l.Z.get("token"))}});return await t.json()}catch(e){console.log(e)}},o=async e=>{try{let t=await fetch("/api/cart/delete-from-cart?id=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(l.Z.get("token"))}});return await t.json()}catch(e){console.log(e)}}},7121:function(e,t,n){"use strict";n.d(t,{GP:function(){return c},GU:function(){return i},Hp:function(){return a},d2:function(){return s},jJ:function(){return r},mO:function(){return u},p8:function(){return l},qe:function(){return d},vV:function(){return o}}),n(994),n(9584);let l=[{id:"home",label:"Home",path:"/"},{id:"listing",label:"Всички продукти",path:"/product/listing/all-products"},{id:"listingMen",label:"Мъже",path:"/product/listing/men"},{id:"listingWomen",label:"Жени",path:"/product/listing/women"},{id:"listingKids",label:"Деца",path:"/product/listing/kids"}],i=[{id:"adminListing",label:"Обновяване на продукт",path:"/admin-view/all-products"},{id:"adminNewProduct",label:"Добавяне на продукти",path:"/admin-view/add-product"},{id:"orders",label:"Поръчки",path:"/admin-view/orders"}],a=[{id:"name",type:"text",placeholder:"Въведете вашето име",label:"Име",componentType:"input"},{id:"email",type:"email",placeholder:"Въведете email адрес",label:"Email адрес",componentType:"input"},{id:"password",type:"password",placeholder:"Въведете парола",label:"Парола",componentType:"input"},{id:"role",type:"",placeholder:"",label:"Role",componentType:"select",options:[{id:"admin",label:"Admin"},{id:"customer",label:"customer"}]}],o=[{id:"email",type:"email",placeholder:"Въведете email адрес",label:"Email",componentType:"input"},{id:"password",type:"password",placeholder:"Въведете парола",label:"Парола",componentType:"input"}],s=[{id:"name",type:"text",placeholder:"Enter name",label:"Име",componentType:"input"},{id:"price",type:"number",placeholder:"Въведете цена",label:"Цена",componentType:"input"},{id:"description",type:"text",placeholder:"Въведете описание",label:"Описание",componentType:"input"},{id:"category",type:"",placeholder:"",label:"Категория",componentType:"select",options:[{id:"men",label:"Мъже"},{id:"women",label:"Жени"},{id:"kids",label:"Деца"}]},{id:"deliveryInfo",type:"text",placeholder:"Въведете адрес",label:"Адрес",componentType:"input"},{id:"onSale",type:"",placeholder:"",label:"Промоция",componentType:"select",options:[{id:"yes",label:"Да"},{id:"no",label:"Не"}]},{id:"priceDrop",type:"number",placeholder:"Въведете намалението в %",label:"Намаление",componentType:"input"}],r=[{id:"s",label:"S"},{id:"m",label:"M"},{id:"l",label:"L"}],c=[{id:"fullName",type:"input",placeholder:"Въведете вашите имена",label:"Три имена",componentType:"input"},{id:"address",type:"input",placeholder:"Въведете адрес",label:"Адрес",componentType:"input"},{id:"city",type:"input",placeholder:"Въведете град",label:"Град",componentType:"input"},{id:"country",type:"input",placeholder:"Въведете държава",label:"Държава",componentType:"input"},{id:"postalCode",type:"input",placeholder:"Въведете пощенски код",label:"Пощенски код",componentType:"input"}],d={apiKey:"AIzaSyD5Alvae8H3a2To1DRjvweJVUuUwYTiF9I",authDomain:"modernik.firebaseapp.com",projectId:"modernik",storageBucket:"modernik.appspot.com",messagingSenderId:"626955762261",appId:"1:626955762261:web:02f40e7c046a9e779372dc",measurementId:"G-BZL21K1RQM"},u="gs://modernik.appspot.com"},3385:function(){}},function(e){e.O(0,[788,226,973,971,938,744],function(){return e(e.s=8871)}),_N_E=e.O()}]);