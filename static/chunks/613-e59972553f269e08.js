(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[613],{2601:function(e,t,n){"use strict";var r,o;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(8960)},613:function(e,t,n){Promise.resolve().then(n.bind(n,607))},607:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var r=n(7437),o=n(4033),i=n(2329),a=n(9166),s=n(7746),c=n(9890),l=n(2265),u=n(171);function d(e){let{item:t}=e,n=(0,o.usePathname)(),{setCurrentUpdatedProduct:d,setComponentLevelLoader:f,componentLevelLoader:h,user:m,showCartModel:p,setShowCartModel:g}=(0,l.useContext)(a.GlobalContext),x=(0,o.useRouter)();async function y(e){f({loading:!0,id:e._id});let t=await (0,c.ak)(e._id);t.success?(f({loading:!1,id:""}),u.Am.success(t.message,{position:u.Am.POSITION.TOP_RIGHT}),x.refresh()):(u.Am.error(t.message,{position:u.Am.POSITION.TOP_RIGHT}),f({loading:!1,id:""}))}async function v(e){f({loading:!0,id:e._id});let t=await (0,s.Xq)({productID:e._id,userID:m._id});t.success?u.Am.success(t.message,{position:u.Am.POSITION.TOP_RIGHT}):u.Am.error(t.message,{position:u.Am.POSITION.TOP_RIGHT}),f({loading:!1,id:""}),g(!0),console.log(t)}return n.includes("admin-view")?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{d(t),x.push("/admin-view/add-product")},className:"mt-1.5 flex w-full justify-center bg-black px-5 py-3 text-xs font-medium uppercase tracking-wide text-white",children:"Update"}),(0,r.jsx)("button",{onClick:()=>y(t),className:"mt-1.5 flex w-full justify-center bg-black px-5 py-3 text-xs font-medium uppercase tracking-wide text-white",children:h&&h.loading&&t._id===h.id?(0,r.jsx)(i.Z,{text:"Изтриване",color:"#ffffff",loading:h&&h.loading}):"DELETE"})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("button",{onClick:()=>v(t),className:"mt-1.5 flex w-full justify-center bg-black px-5 py-3 text-xs font-medium uppercase tracking-wide text-white",children:h&&h.loading&&h.id===t._id?(0,r.jsx)(i.Z,{text:"Добави в количката",color:"#ffffff",loading:h&&h.loading}):"Добави в количката"})})}function f(e){let{item:t}=e,n=(0,o.useRouter)();return(0,r.jsxs)("div",{onClick:()=>n.push("/product/".concat(t._id)),children:[(0,r.jsx)("div",{className:"overflow-hideen aspect-w-1 aspect-h-1 h-52",children:(0,r.jsx)("img",{src:t.imageUrl,alt:"Product image",className:"h-full w-full object-cover transition-all duration-300 group-hover:scale-125"})}),"yes"===t.onSale?(0,r.jsx)("div",{className:"absolute top-0 m-2 rounded-full bg-black",children:(0,r.jsx)("p",{className:"rounded-full  p-1 text-[8px] font-bold uppercase tracking-wide text-white sm:py-1 sm:px-3",children:"Sale"})}):null,(0,r.jsxs)("div",{className:"my-4 mx-auto flex w-10/12 flex-col items-start justify-between",children:[(0,r.jsxs)("div",{className:"mb-2 flex",children:[(0,r.jsx)("p",{className:"mr-3 text-sm font-semibold ".concat("yes"===t.onSale?"line-through":""),children:"$ ".concat(t.price)}),"yes"===t.onSale?(0,r.jsx)("p",{className:"mr-3 text-sm font-semibold text-red-700",children:"$ ".concat((t.price-t.price*(t.priceDrop/100)).toFixed(2))}):null,"yes"===t.onSale?(0,r.jsx)("p",{className:"mr-3 text-sm font-semibold",children:"-(".concat(t.priceDrop,"%)off")}):null]}),(0,r.jsx)("h3",{className:"md-2 text-gray-400 text-sm",children:t.name})]})]})}var h=n(3151);function m(e){let{data:t}=e,n=(0,o.useRouter)();return(0,l.useEffect)(()=>{n.refresh()},[]),(0,r.jsxs)("section",{className:"bg-white py-12 sm:py-16",children:[(0,r.jsx)("div",{className:"mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"mt-10 grid grid-cols-2 gap-6 sm:grid-cols-4 sm:gap-4 lg:mt-16",children:t&&t.length?t.map(e=>(0,r.jsxs)("article",{className:"relative flex flex-col overflow-hidden border cursor-pointer",children:[(0,r.jsx)(f,{item:e}),(0,r.jsx)(d,{item:e})]},e._id)):null})}),(0,r.jsx)(h.Z,{})]})}},2329:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7437),o=n(6535);function i(e){let{text:t,color:n,loading:i,size:a}=e;return(0,r.jsxs)("span",{className:"flex gap-1 items-center",children:[t,(0,r.jsx)(o.Z,{color:n,loading:i,size:a||10,"data-testid":"loader"})]})}},3151:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7437),o=n(171);function i(){return(0,r.jsx)(o.Ix,{position:"top-right",autoClose:4e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light",rtl:!1})}n(8062)},9166:function(e,t,n){"use strict";n.r(t),n.d(t,{GlobalContext:function(){return s},default:function(){return d},initialCheckoutFormData:function(){return c}});var r=n(7437),o=n(1490),i=n(4033),a=n(2265);let s=(0,a.createContext)(null),c={shippingAddress:{},paymentMethod:"",totalPrice:0,isPaid:!1,paidAt:new Date,isProcessing:!0},l=["cart","checkout","account","orders","admin-view"],u=["/admin-view","/admin-view/add-product","/admin-view/all-products"];function d(e){let{children:t}=e,[n,d]=(0,a.useState)(!1),[f,h]=(0,a.useState)(!0),[m,p]=(0,a.useState)({loading:!1,id:""}),[g,x]=(0,a.useState)(null),[y,v]=(0,a.useState)(null),[w,j]=(0,a.useState)(null),[b,T]=(0,a.useState)(!1),[k,S]=(0,a.useState)([]),[N,O]=(0,a.useState)([]),[E,P]=(0,a.useState)({fullName:"",city:"",country:"",postalCode:"",address:""}),[I,_]=(0,a.useState)(c),[A,C]=(0,a.useState)([]),[Z,L]=(0,a.useState)(null),[D,R]=(0,a.useState)([]),z=(0,i.useRouter)(),B=(0,i.usePathname)();return(0,a.useEffect)(()=>{if(void 0!==o.Z.get("token")){x(!0);let e=JSON.parse(localStorage.getItem("user"))||{},t=JSON.parse(localStorage.getItem("cartItems"))||[];v(e),S(t)}else x(!1),v({})},[o.Z]),(0,a.useEffect)(()=>{"/register"!==B&&!B.includes("product")&&"/"!==B&&y&&0===Object.keys(y).length&&l.includes(B)>-1&&z.push("/login")},[y,B]),(0,a.useEffect)(()=>{null!==y&&y&&Object.keys(y).length>0&&(null==y?void 0:y.role)!=="admin"&&u.indexOf(B)>-1&&z.push("/unauthorized-page")},[y,B]),(0,r.jsx)(s.Provider,{value:{showNavmodel:n,setShowNavmodel:d,pageLevelLoader:f,setPageLevelLoader:h,isAuthUser:g,setIsAuthUser:x,user:y,setUser:v,componentLevelLoader:m,setComponentLevelLoader:p,currentUpdatedProduct:w,setCurrentUpdatedProduct:j,showCartModel:b,setShowCartModel:T,cartItems:k,setCartItems:S,addresses:N,setAddresses:O,addressFormData:E,setAddressFormData:P,checkoutFormData:I,setCheckoutFormData:_,allOrdersForUser:A,setAllOrdersForUser:C,orderDetails:Z,setOrderDetails:L,allOrdersForAllUsers:D,setAllOrdersForAllUsers:R},children:t})}},7746:function(e,t,n){"use strict";n.d(t,{EI:function(){return a},Xq:function(){return o},tQ:function(){return i}});var r=n(1490);let o=async e=>{try{let t=await fetch("/api/cart/add-to-cart",{method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer ".concat(r.Z.get("token"))},body:JSON.stringify(e)});return await t.json()}catch(e){console.log(e)}},i=async e=>{try{let t=await fetch("/api/cart/all-cart-items?id=".concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(r.Z.get("token"))}});return await t.json()}catch(e){console.log(e)}},a=async e=>{try{let t=await fetch("/api/cart/delete-from-cart?id=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r.Z.get("token"))}});return await t.json()}catch(e){console.log(e)}}},9890:function(e,t,n){"use strict";n.d(t,{Tw:function(){return c},ak:function(){return l},c0:function(){return s},xg:function(){return i}});var r=n(1490),o=n(2601);let i=async e=>{try{let t=await fetch("/api/admin/add-product",{method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer ".concat(r.Z.get("token"))},body:JSON.stringify(e)});return await t.json()}catch(e){console.log(e)}},a=o.env.NEXT_PUBLIC_API_URL||"http://localhost:3000",s=async()=>{try{let e=await fetch("".concat(a,"/api/admin/all-products"),{method:"GET",cache:"no-store"});return await e.json()}catch(e){console.log(e)}},c=async e=>{try{let t=await fetch("/api/admin/update-product",{method:"PUT",headers:{"content-type":"application/json",Authorization:"Bearer ".concat(r.Z.get("token"))},cache:"no-store",body:JSON.stringify(e)});return await t.json()}catch(e){console.log(e)}},l=async e=>{try{let t=await fetch("/api/admin/delete-product?id=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r.Z.get("token"))}});return await t.json()}catch(e){console.log(e)}}},8062:function(){},8960:function(e){!function(){var t={229:function(e){var t,n,r,o=e.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c=[],l=!1,u=-1;function d(){l&&r&&(l=!1,r.length?c=r.concat(c):u=-1,c.length&&f())}function f(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(r=c,c=[];++u<t;)r&&r[u].run();u=-1,t=c.length}r=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}},a=!0;try{t[e](i,i.exports,r),a=!1}finally{a&&delete n[e]}return i.exports}r.ab="//";var o=r(229);e.exports=o}()}}]);