"use strict";(()=>{var e={};e.id=5569,e.ids=[5569],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},20463:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>x,originalPathname:()=>j,patchFetch:()=>P,requestAsyncStorage:()=>w,routeModule:()=>v,serverHooks:()=>q,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>y});var s={};t.r(s),t.d(s,{POST:()=>h,dynamic:()=>m});var o=t(95419),a=t(69108),i=t(99678),n=t(82338),u=t(88582),c=t(6521),l=t(68619),d=t.n(l),p=t(78070);let g=d().object({name:d().string().required(),email:d().string().email().required(),password:d().string().min(6).required(),role:d().string().required()}),m="force-dynamic";async function h(e){await (0,n.Z)();let{name:r,email:t,password:s,role:o}=await e.json(),{error:a}=g.validate({name:r,email:t,password:s,role:o});if(a)return console.log(a),p.Z.json({success:!1,message:a.details[0].message});try{if(await u.Z.findOne({email:t}))return p.Z.json({success:!1,message:"Вече има регистриран потребител с този email адрес!"});{let e=await (0,c.hash)(s,12);if(await u.Z.create({name:r,email:t,password:e,role:o}))return p.Z.json({success:!0,message:"Успешно създадохте акаунт!"})}}catch(e){return console.log("Натъкнахте се на грешка при създаване на акаунт"),p.Z.json({success:!1,message:"Нещо се обърка, моля опитайте отново!"})}}let v=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/register/route",pathname:"/api/register",filename:"route",bundlePath:"app/api/register/route"},resolvedPagePath:"D:\\Programming\\E-commerce App w NextJS\\ecommerce - Copy\\src\\app\\api\\register\\route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:w,staticGenerationAsyncStorage:f,serverHooks:q,headerHooks:x,staticGenerationBailout:y}=v,j="/api/register/route";function P(){return(0,i.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:f})}},82338:(e,r,t)=>{t.d(r,{Z:()=>i});var s=t(11185),o=t.n(s);let a={useNewUrlParser:!0,useUnifiedTopology:!0},i=async()=>{o().connect("mongodb+srv://burov96:123456782023@cluster0.p1f5hzv.mongodb.net/",a).then(()=>console.log("Успешна връзка с база данни!")).catch(e=>console.log(`Получихте следното съобщение от база данни : ${e.message}`))}},88582:(e,r,t)=>{t.d(r,{Z:()=>i});var s=t(11185),o=t.n(s);let a=new(o()).Schema({name:String,email:String,password:String,role:String}),i=o().models.User||o().model("User",a)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[1638,6206,734,6521],()=>t(20463));module.exports=s})();