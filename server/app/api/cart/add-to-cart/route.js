"use strict";(()=>{var e={};e.id=892,e.ids=[892],e.modules={46517:e=>{e.exports=require("lodash")},11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},56690:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>x,originalPathname:()=>Z,patchFetch:()=>b,requestAsyncStorage:()=>y,routeModule:()=>h,serverHooks:()=>q,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>j});var s={};t.r(s),t.d(s,{POST:()=>f,dynamic:()=>g});var o=t(95419),a=t(69108),c=t(99678),n=t(82338),u=t(48967),i=t(73873),d=t(68619),l=t.n(d),p=t(78070);let m=l().object({userID:l().string().required(),productID:l().string().required()}),g="force-dynamic";async function f(e){try{if(await (0,n.Z)(),!await (0,u.Z)(e))return p.Z.json({success:!1,message:"Не сте удостоверени!"});{let r=await e.json(),{productID:t,userID:s}=r,{error:o}=m.validate({userID:s,productID:t});if(o)return p.Z.json({success:!1,message:o.details[0].message});console.log(t,s);let a=await i.Z.find({productID:t,userID:s});if(console.log(a),a?.length>0)return p.Z.json({success:!1,message:"Този продукт вече присъства в количката!"});let c=await i.Z.create(r);if(console.log(c),c)return p.Z.json({success:!0,message:"Продукта е добавен успешно"});return p.Z.json({success:!1,message:"Продукта не може да бъде добавен!"})}}catch(e){return console.log(e),p.Z.json({success:!1,message:"Нещо се обърка, опитайте отново по-късно!"})}}let h=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/cart/add-to-cart/route",pathname:"/api/cart/add-to-cart",filename:"route",bundlePath:"app/api/cart/add-to-cart/route"},resolvedPagePath:"D:\\Programming\\E-commerce App w NextJS\\ecommerce - Copy\\src\\app\\api\\cart\\add-to-cart\\route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:y,staticGenerationAsyncStorage:v,serverHooks:q,headerHooks:x,staticGenerationBailout:j}=h,Z="/api/cart/add-to-cart/route";function b(){return(0,c.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:v})}},82338:(e,r,t)=>{t.d(r,{Z:()=>c});var s=t(11185),o=t.n(s);let a={useNewUrlParser:!0,useUnifiedTopology:!0},c=async()=>{o().connect("mongodb+srv://burov96:123456782023@cluster0.p1f5hzv.mongodb.net/",a).then(()=>console.log("Успешна връзка с база данни!")).catch(e=>console.log(`Получихте следното съобщение от база данни : ${e.message}`))}},48967:(e,r,t)=>{t.d(r,{Z:()=>a});var s=t(46082),o=t.n(s);let a=async e=>{let r=e.headers.get("Authorization")?.split(" ")[1];if(!r)return!1;try{let e=o().verify(r,"default_secret_key");if(e)return e}catch(e){return console.log(e),!1}}},73873:(e,r,t)=>{t.d(r,{Z:()=>c});var s=t(11185),o=t.n(s);let a=new(o()).Schema({userID:{type:o().Schema.Types.ObjectId,ref:"User"},productID:{type:o().Schema.Types.ObjectId,ref:"Products"},quantity:{type:Number,required:!0,default:1}},{timestamps:!0}),c=o().models.Cart||o().model("Cart",a)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[1638,6206,6082,734],()=>t(56690));module.exports=s})();