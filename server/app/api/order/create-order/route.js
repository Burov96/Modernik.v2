"use strict";(()=>{var e={};e.id=9828,e.ids=[9828],e.modules={46517:e=>{e.exports=require("lodash")},11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},40038:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>f,originalPathname:()=>v,patchFetch:()=>P,requestAsyncStorage:()=>g,routeModule:()=>y,serverHooks:()=>h,staticGenerationAsyncStorage:()=>S,staticGenerationBailout:()=>q});var o={};t.r(o),t.d(o,{POST:()=>l,dynamic:()=>m});var s=t(95419),a=t(69108),i=t(99678),n=t(82338),d=t(48967),u=t(73873),c=t(2068),p=t(78070);let m="force-dynamic";async function l(e){try{if(await (0,n.Z)(),!await (0,d.Z)(e))return p.Z.json({success:!1,message:"Не сте удостоверени!"});{let r=await e.json(),{user:t}=r;if(await c.Z.create(r))return await u.Z.deleteMany({userID:t}),p.Z.json({success:!0,message:"Поръчката ви е на път!"});return p.Z.json({success:!1,message:"Не успяхте да създадете поръчка, моля опитайте отново!"})}}catch(e){return p.Z.json({success:!1,message:"Нещо се обърка, опитайте отново по-късно!"})}}let y=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/order/create-order/route",pathname:"/api/order/create-order",filename:"route",bundlePath:"app/api/order/create-order/route"},resolvedPagePath:"D:\\Programming\\E-commerce App w NextJS\\ecommerce - Copy\\src\\app\\api\\order\\create-order\\route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:g,staticGenerationAsyncStorage:S,serverHooks:h,headerHooks:f,staticGenerationBailout:q}=y,v="/api/order/create-order/route";function P(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:S})}},82338:(e,r,t)=>{t.d(r,{Z:()=>i});var o=t(11185),s=t.n(o);let a={useNewUrlParser:!0,useUnifiedTopology:!0},i=async()=>{s().connect("mongodb+srv://burov96:123456782023@cluster0.p1f5hzv.mongodb.net/",a).then(()=>console.log("Успешна връзка с база данни!")).catch(e=>console.log(`Получихте следното съобщение от база данни : ${e.message}`))}},48967:(e,r,t)=>{t.d(r,{Z:()=>a});var o=t(46082),s=t.n(o);let a=async e=>{let r=e.headers.get("Authorization")?.split(" ")[1];if(!r)return!1;try{let e=s().verify(r,"default_secret_key");if(e)return e}catch(e){return console.log(e),!1}}},73873:(e,r,t)=>{t.d(r,{Z:()=>i});var o=t(11185),s=t.n(o);let a=new(s()).Schema({userID:{type:s().Schema.Types.ObjectId,ref:"User"},productID:{type:s().Schema.Types.ObjectId,ref:"Products"},quantity:{type:Number,required:!0,default:1}},{timestamps:!0}),i=s().models.Cart||s().model("Cart",a)},2068:(e,r,t)=>{t.d(r,{Z:()=>i});var o=t(11185),s=t.n(o);t(2440),t(88582);let a=new(s()).Schema({user:{type:s().Schema.Types.ObjectId,ref:"User",required:!0},orderItems:[{qty:{type:Number,required:!0},product:{type:s().Schema.Types.ObjectId,ref:"Products"}}],shippingAddress:{fullName:{type:String,required:!0},address:{type:String,required:!0},city:{type:String,required:!0},country:{type:String,required:!0},postalCode:{type:String,required:!0}},paymentMethod:{type:String,required:!0,default:"Stripe"},totalPrice:{type:Number,required:!0},isPaid:{type:Boolean,required:!0},paidAt:{type:Date,required:!0},isProcessing:{type:Boolean,required:!0}},{timestamps:!0}),i=s().models.Order||s().model("Order",a)},2440:(e,r,t)=>{t.d(r,{Z:()=>i});var o=t(11185),s=t.n(o);let a=new(s()).Schema({name:String,description:String,price:Number,category:String,sizes:Array,deliveryInfo:String,onSale:String,priceDrop:Number,imageUrl:String},{timestamps:!0}),i=s().models.Products||s().model("Products",a)},88582:(e,r,t)=>{t.d(r,{Z:()=>i});var o=t(11185),s=t.n(o);let a=new(s()).Schema({name:String,email:String,password:String,role:String}),i=s().models.User||s().model("User",a)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[1638,6206,6082],()=>t(40038));module.exports=o})();